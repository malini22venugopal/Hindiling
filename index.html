<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>рд╣рд┐рдВрджреА рдСрдбрд┐рдпреЛ рдХреНрд╡рд┐рдЬрд╝ тАФ рд▓рд┐рдВрдЧ & рд╡рдЪрди (30 рдкреНрд░рд╢реНрди)</title>
<style>
  body{font-family:'Noto Sans Devanagari',sans-serif;background:#f8fbff;margin:0;padding:28px;display:flex;justify-content:center;}
  .box{width:820px;max-width:98%;background:#fff;padding:24px;border-radius:14px;box-shadow:0 6px 26px rgba(0,0,0,0.08);}
  h1{text-align:center;font-size:22px;margin:0 0 10px;color:#123464;}
  #startScreen{text-align:center;padding:20px;}
  #questionArea{display:none;}
  #questionText{font-size:20px;text-align:center;margin:18px 0;color:#111;}
  .controls{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin:12px 0;}
  input[type="text"]{width:70%;padding:10px 12px;font-size:16px;border-radius:8px;border:1px solid #ccd;}
  button{padding:10px 16px;font-size:15px;border:none;border-radius:8px;cursor:pointer;background:#007bff;color:#fff;}
  button.secondary{background:#6c757d;}
  #status,#feedbackText,#score{text-align:center;margin-top:10px;font-weight:700;}
  #feedbackText{font-size:18px;}
  #score{color:#1a7f3a;}
</style>
</head>
<body>
<div class="box">
  <h1>ЁЯОз рд╣рд┐рдВрджреА рдСрдбрд┐рдпреЛ рдХреНрд╡рд┐рдЬрд╝ тАФ рд▓рд┐рдВрдЧ & рд╡рдЪрди (30 рдкреНрд░рд╢реНрди)</h1>

  <div id="startScreen">
    <p style="font-size:16px;">рдХреНрд╡рд┐рдЬрд╝ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ тАЬрд╢реБрд░реВ рдХрд░реЗрдВтАЭ рджрдмрд╛рдПрдБред</p>
    <button id="startBtn">ЁЯФШ рд╢реБрд░реВ рдХрд░реЗрдВ</button>
    <p style="font-size:13px;color:#555;">рдХреБрд▓ рдкреНрд░рд╢реНрди: 30 ┬╖ рдорд┐рд╢реНрд░рд┐рдд рд▓рд┐рдВрдЧ рдФрд░ рд╡рдЪрди ┬╖ Chrome рдореЗрдВ mic рдЕрдиреБрдорддрд┐ рджреЗрдВ</p>
  </div>

  <div id="questionArea">
    <div id="questionText">Play рджрдмрд╛рдПрдБ тАФ рдкреНрд░рд╢реНрди рд╕реНрд╡рддрдГ рдкрдврд╝реЗ рдЬрд╛рдПрдБрдЧреЗред</div>

    <div style="text-align:center;margin:12px 0;">
      <input id="answerInput" type="text" placeholder="рдпрд╣рд╛рдБ рдЖрд╡рд╛рдЬрд╝ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдЙрддреНрддрд░ рджрд┐рдЦреЗрдЧрд╛ тАФ рдпрд╛ рдЯрд╛рдЗрдк рдХрд░реЗрдВ" disabled />
    </div>

    <div class="controls">
      <button id="playBtn">ЁЯФК Play</button>
      <button id="speakBtn" disabled>ЁЯОд Speak</button>
      <button id="submitBtn" disabled>Submit</button>
      <button id="passBtn" class="secondary" disabled>Pass</button>
      <button id="replayBtn" class="secondary" disabled>ЁЯФБ Replay</button>
    </div>

    <div id="status"></div>
    <div id="feedbackText"></div>
    <div id="score"></div>
  </div>
</div>

<script>
// -------------------- QUESTIONS --------------------
const vachanQuestions = [
  { word: "рдкрд╛рдард╢рд╛рд▓рд╛", answers:["рдкрд╛рдард╢рд╛рд▓рд╛рдПрдБ","рдкрд╛рдард╢рд╛рд▓рд╛рдПрдВ","рдкрд╛рдард╢рд╛рд▓рд╛рдпреЗрдВ"] },
  { word: "рдорд╛рд▓рд╛", answers:["рдорд╛рд▓рд╛рдПрдБ","рдорд╛рд▓рд╛рдПрдВ","рдорд╛рд▓рд╛рдпреЗрдВ"] },
  { word: "рдЪрд┐рдбрд╝рд┐рдпрд╛", answers:["рдЪрд┐рдбрд╝рд┐рдпрд╛рдПрдБ","рдЪрд┐рдбрд╝рд┐рдпрд╛рдПрдВ","рдЪрд┐рдбрд╝рд┐рдпрд╛рдпреЗрдВ"] },
  { word: "рдЧреБрдбрд╝рд┐рдпрд╛", answers:["рдЧреБрдбрд╝рд┐рдпрд╛рдБ","рдЧреБрдбрд╝рд┐рдпрд╛рдВ"] },
  { word: "рд▓рдбрд╝рдХреА", answers:["рд▓рдбрд╝рдХрд┐рдпрд╛рдБ","рд▓рдбрд╝рдХрд┐рдпрд╛рдВ"] },
  { word: "рдирджреА", answers:["рдирджрд┐рдпрд╛рдБ","рдирджрд┐рдпрд╛рдВ"] },
  { word: "рд░реЛрдЯреА", answers:["рд░реЛрдЯрд┐рдпрд╛рдБ","рд░реЛрдЯрд┐рдпрд╛рдВ"] },
  { word: "рдЧрд╛рдбрд╝реА", answers:["рдЧрд╛рдбрд╝рд┐рдпрд╛рдБ","рдЧрд╛рдбрд╝рд┐рдпреЛрдВ"] },
  { word: "рдХреБрд░реНрд╕реА", answers:["рдХреБрд░реНрд╕рд┐рдпрд╛рдБ","рдХреБрд░реНрд╕рд┐рдпрд╛рдВ"] },
  { word: "рдХрд┐рддрд╛рдм", answers:["рдХрд┐рддрд╛рдмреЗрдВ","рдХрд┐рддрд╛рдмреЛрдВ"] },
  { word: "рд▓рдбрд╝рдХрд╛", answers:["рд▓рдбрд╝рдХреЗ","рд▓рдбрд╝рдХреЗрдВ","рд▓рдбрд╝рдХреЛрдВ"] },
  { word: "рд░реБрдкрдпрд╛", answers:["рд░реБрдкрдпреЗ","рд░реБрдкрдП"] },
  { word: "рдХрдорд░рд╛", answers:["рдХрдорд░реЗ","рдХрдорд░реЛрдВ"] },
  { word: "рддрд╕реНрд╡реАрд░", answers:["рддрд╕реНрд╡реАрд░реЗрдВ","рддрд╕реНрд╡реАрд░реЛрдВ"] },
  { word: "рд╕реЗрдм", answers:["рд╕реЗрдм","рд╕реЗрдмреЛрдВ"] }
];

const lingQuestions = [
  { word: "рдкрд┐рддрд╛", male:["рдкрд┐рддрд╛","рдкрд┐рддрд╛рдЬреА"], female:["рдорд╛рддрд╛","рдорд╛рдБ","рдорд╛рдВ","рдорд╛рддрд╛ рдЬреА"] },
  { word: "рдкреБрддреНрд░", male:["рдкреБрддреНрд░"], female:["рдкреБрддреНрд░реА"] },
  { word: "рдШреЛрдбрд╝рд╛", male:["рдШреЛрдбрд╝рд╛","рдШреЛрдбрд╝реЗ"], female:["рдШреЛрдбрд╝реА"] },
  { word: "рд╢реЗрд░", male:["рд╢реЗрд░"], female:["рд╢реЗрд░рдиреА"] },
  { word: "рдирд░", male:["рдирд░"], female:["рдирд╛рд░реА","рдорд╛рджрд╛","рд╕реНрддреНрд░реА"] },
  { word: "рд╢рд┐рд╖реНрдп", male:["рд╢рд┐рд╖реНрдп"], female:["рд╢рд┐рд╖реНрдпрд╛"] },
  { word: "рдирд╛рдирд╛", male:["рдирд╛рдирд╛"], female:["рдирд╛рдиреА"] },
  { word: "рд╕реЗрда", male:["рд╕реЗрда"], female:["рд╕реЗрдард╛рдиреА","рд╕реЗрдардиреА"] },
  { word: "рдкрддрд┐", male:["рдкрддрд┐"], female:["рдкрддреНрдиреА"] },
  { word: "рдореБрд░реНрдЧрд╛", male:["рдореБрд░реНрдЧрд╛"], female:["рдореБрд░реНрдЧреА"] },
  { word: "рд░рд╛рдЬрд╛", male:["рд░рд╛рдЬрд╛"], female:["рд░рд╛рдиреА"] },
  { word: "рдЖрджрдореА", male:["рдЖрджрдореА"], female:["рдФрд░рдд","рдорд╣рд┐рд▓рд╛","рд╕реНрддреНрд░реА"] },
  { word: "рдЕрднрд┐рдиреЗрддрд╛", male:["рдЕрднрд┐рдиреЗрддрд╛"], female:["рдЕрднрд┐рдиреЗрддреНрд░реА"] },
  { word: "рднрд╛рдИ", male:["рднрд╛рдИ"], female:["рдмрд╣рди"] },
  { word: "рдЕрдзреНрдпрд╛рдкрдХ", male:["рдЕрдзреНрдпрд╛рдкрдХ"], female:["рдЕрдзреНрдпрд╛рдкрд┐рдХрд╛"] }
];

// Combine & shuffle
let questions = [];
vachanQuestions.forEach(q => questions.push({type:'vachan',word:q.word,answers:q.answers}));
lingQuestions.forEach(q => questions.push({type:'ling',word:q.word,male:q.male,female:q.female}));
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}}
shuffle(questions);

// -------------------- UI --------------------
const startScreen=document.getElementById("startScreen");
const questionArea=document.getElementById("questionArea");
const startBtn=document.getElementById("startBtn");
const qText=document.getElementById("questionText");
const ans=document.getElementById("answerInput");
const playBtn=document.getElementById("playBtn");
const speakBtn=document.getElementById("speakBtn");
const submitBtn=document.getElementById("submitBtn");
const passBtn=document.getElementById("passBtn");
const replayBtn=document.getElementById("replayBtn");
const status=document.getElementById("status");
const feedback=document.getElementById("feedbackText");
const scoreDiv=document.getElementById("score");

let current=0,score=0,lastSpoken="",recognitionAvailable=false,recognition=null,voice=null;

// -------------------- Voice Functions --------------------
function chooseVoice(){
  const v=speechSynthesis.getVoices();
  const hi=v.filter(x=>/hi|hindi/i.test(x.lang||""));
  const female=hi.find(x=>/female|Aditi|Shruti|Google/.test(x.name))||hi[0];
  return female||v[0];
}
function speak(txt){
  lastSpoken=txt;
  const u=new SpeechSynthesisUtterance(txt);
  u.lang="hi-IN"; u.rate=0.95; if(voice)u.voice=voice;
  speechSynthesis.cancel(); speechSynthesis.speak(u);
}

// -------------------- Helpers --------------------
function normalize(s){return (s||"").normalize("NFD").replace(/[\u093C-\u094D\u0964-\u0965\s\p{P}]/gu,"").toLowerCase();}
function lev(a,b){if(a===b)return 0;let m=[],al=a.length,bl=b.length;for(let i=0;i<=al;i++){m[i]=[i];for(let j=1;j<=bl;j++){m[i][j]=i===0?j:0;}for(let i=1;i<=al;i++){for(let j=1;j<=bl;j++){m[i][j]=a[i-1]===b[j-1]?m[i-1][j-1]:Math.min(m[i-1][j]+1,m[i][j-1]+1,m[i-1][j-1]+1);}}return m[al][bl];}
function match(a,b){a=normalize(a);b=normalize(b);if(a===b)return true;return lev(a,b)<=Math.max(1,Math.floor(Math.max(a.length,b.length)*0.25));}

// -------------------- Question Logic --------------------
function nextQ(){
  if(current>=questions.length)return endQuiz();
  const q=questions[current];
  let prompt,expected;
  if(q.type==="vachan"){prompt=`рд╡рдЪрди рдмрджрд▓рд┐рдП: ${q.word} рдХрд╛ рдмрд╣реБрд╡рдЪрди рдмрддрд╛рдЗрдП`;expected=q.answers;}
  else{
    const femaleWords=["рд░рд╛рдиреА","рд╢реЗрд░рдиреА","рдкрддреНрдиреА","рдирд╛рдиреА","рдореБрд░реНрдЧреА","рдкреБрддреНрд░реА","рдЕрдзреНрдпрд╛рдкрд┐рдХрд╛"];
    if(femaleWords.includes(q.word)){prompt=`рд▓рд┐рдВрдЧ рдмрджрд▓рд┐рдП: ${q.word} рдХрд╛ рдкреБрд▓реНрд▓рд┐рдВрдЧ рдмрддрд╛рдЗрдП`;expected=q.male;}
    else{prompt=`рд▓рд┐рдВрдЧ рдмрджрд▓рд┐рдП: ${q.word} рдХрд╛ рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ рдмрддрд╛рдЗрдП`;expected=q.female;}
  }
  q._expected=expected;
  qText.textContent=prompt; ans.value=""; feedback.textContent=""; status.textContent=""; ans.disabled=false;
  submitBtn.disabled=false; passBtn.disabled=false; replayBtn.disabled=false; if(recognitionAvailable)speakBtn.disabled=false;
  setTimeout(()=>speak(prompt),400);
}

function correct(){
  score++;
  feedback.textContent="тЬЕ рд╕рд╣реА рдЙрддреНрддрд░!";
  feedback.style.color="#1a7f3a";
  ans.disabled=true; submitBtn.disabled=true; passBtn.disabled=true;
  speak("рд╕рд╣реА рдЙрддреНрддрд░");
  setTimeout(()=>{current++; nextQ();},2500);
}

function wrong(showAnswer=false){
  feedback.style.color="#c00";
  ans.disabled=true; submitBtn.disabled=true; passBtn.disabled=true;
  if(showAnswer){
    feedback.textContent="тЭМ рдЧрд▓рдд рдЙрддреНрддрд░! рд╕рд╣реА рдЙрддреНрддрд░: "+questions[current]._expected.join(", ");
    speak("рдЧрд▓рдд рдЙрддреНрддрд░, рд╕рд╣реА рдЙрддреНрддрд░: "+questions[current]._expected[0]);
    setTimeout(()=>{current++; nextQ();},3000);
  }else{
    feedback.textContent="тЭМ рдЧрд▓рдд рдЙрддреНрддрд░! рдлрд┐рд░ рд╕реЗ рдмреЛрд▓реЗрдВ рдпрд╛ Pass рджрдмрд╛рдПрдБред";
    speak("рдЧрд▓рдд рдЙрддреНрддрд░");
  }
}

// -------------------- Button Events --------------------
submitBtn.onclick=()=>{const val=ans.value.trim();if(!val)return;const list=questions[current]._expected;if(list.some(x=>match(val,x)))correct();else wrong();};
passBtn.onclick=()=>{wrong(true);};
replayBtn.onclick=()=>{if(lastSpoken)speak(lastSpoken);};
playBtn.onclick=()=>{current=0;score=0;shuffle(questions);nextQ();};
startBtn.onclick=()=>{
  startScreen.style.display="none";questionArea.style.display="block";
  voice=chooseVoice();speak("рдЪрд▓реЛ, рд╣рдо рд╣рд┐рдВрджреА рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рдЗрдПред");
  setTimeout(()=>playBtn.click(),900);
};

// -------------------- Speech Recognition --------------------
try{
  const R=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(R){
    recognition=new R();
    recognition.lang="hi-IN";
    recognition.interimResults=false;
    recognition.maxAlternatives=1;
    recognition.onresult=e=>{
      const txt=e.results[0][0].transcript.trim(); ans.value=txt;
      const list=questions[current]._expected;
      if(list.some(x=>match(txt,x))) correct(); else wrong();
      speakBtn.disabled=false; status.textContent="";
    };
    recognition.onerror=e=>{status.textContent="ЁЯОЩя╕П рддреНрд░реБрдЯрд┐: "+e.error; speakBtn.disabled=false;};
    speakBtn.onclick=()=>{
      status.textContent="ЁЯОЩя╕П рд╕реБрди рд░рд╣рд╛ рд╣реВрдБтАж";
      speakBtn.disabled=true;
      try{recognition.start();}catch{}
    };
    recognitionAvailable=true;
  }
}catch(e){console.warn(e);}

// -------------------- End Quiz --------------------
function endQuiz(){
  qText.textContent="рдХреНрд╡рд┐рдЬрд╝ рд╕рдорд╛рдкреНрдд!";
  ans.disabled=true; submitBtn.disabled=passBtn.disabled=speakBtn.disabled=replayBtn.disabled=true;
  scoreDiv.textContent=`рдЖрдкрдХрд╛ рд╕реНрдХреЛрд░: ${score} / ${questions.length}`;
  speak(`рдХреНрд╡рд┐рдЬрд╝ рд╕рдорд╛рдкреНрддред рдЖрдкрдХрд╛ рд╕реНрдХреЛрд░ ${score} рдореЗрдВ рд╕реЗ ${questions.length} рд╣реИред`);
}
</script>
</body>
</html>
