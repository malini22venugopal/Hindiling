<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>рд╣рд┐рдВрджреА рдСрдбрд┐рдпреЛ рдХреНрд╡рд┐рдЬрд╝ тАФ рд▓рд┐рдВрдЧ & рд╡рдЪрди</title>
<style>
  body{font-family:'Noto Sans Devanagari',sans-serif;background:#fffdf9;margin:0;padding:20px;text-align:center}
  h1{color:#b71c1c}
  #questionText{font-size:1.5em;margin:25px 0}
  input{padding:10px;font-size:1.1em;width:80%;max-width:320px;border:2px solid #ccc;border-radius:10px;text-align:center}
  button{margin:6px;padding:10px 15px;border:none;border-radius:8px;background:#1565c0;color:#fff;font-size:1em}
  button:hover{background:#0d47a1}
  #feedbackText{margin-top:10px;font-size:1.2em;font-weight:bold}
  #score{font-size:1.3em;margin-top:20px;color:#00695c}
</style>
</head>
<body>
<h1>рд╣рд┐рдВрджреА рдСрдбрд┐рдпреЛ рдХреНрд╡рд┐рдЬрд╝ тАФ рд▓рд┐рдВрдЧ & рд╡рдЪрди</h1>

<div id="questionText">рдХреНрд╡рд┐рдЬрд╝ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ</div>
<input id="answerInput" placeholder="рдЙрддреНрддрд░ рд▓рд┐рдЦреЗрдВ рдпрд╛ рдмреЛрд▓реЗрдВ"/>
<div>
  <button id="submitBtn">рдЬрд╛рдБрдЪреЗрдВ</button>
  <button id="speakBtn">ЁЯОЩя╕П рдмреЛрд▓реЗрдВ</button>
  <button id="passBtn">рдкрд╛рд╕</button>
  <button id="replayBtn">ЁЯФБ рджреЛрд╣рд░рд╛рдПрдБ</button>
</div>
<div><button id="playBtn">тЦ╢я╕П рд╢реБрд░реВ рдХрд░реЗрдВ</button></div>
<div id="feedbackText"></div>
<div id="status"></div>
<div id="score"></div>

<script>
const vachanQuestions = [
  { word: "рдкрд╛рдард╢рд╛рд▓рд╛", answers:["рдкрд╛рдард╢рд╛рд▓рд╛рдПрдБ","рдкрд╛рдард╢рд╛рд▓рд╛рдПрдВ"] },
  { word: "рдорд╛рд▓рд╛", answers:["рдорд╛рд▓рд╛рдПрдБ","рдорд╛рд▓рд╛рдПрдВ"] },
  { word: "рдЪрд┐рдбрд╝рд┐рдпрд╛", answers:["рдЪрд┐рдбрд╝рд┐рдпрд╛рдПрдБ","рдЪрд┐рдбрд╝рд┐рдпрд╛рдПрдВ"] },
  { word: "рдЧреБрдбрд╝рд┐рдпрд╛", answers:["рдЧреБрдбрд╝рд┐рдпрд╛рдБ","рдЧреБрдбрд╝рд┐рдпрд╛рдВ"] },
  { word: "рд▓рдбрд╝рдХреА", answers:["рд▓рдбрд╝рдХрд┐рдпрд╛рдБ","рд▓рдбрд╝рдХрд┐рдпрд╛рдВ"] },
  { word: "рдирджреА", answers:["рдирджрд┐рдпрд╛рдБ","рдирджрд┐рдпрд╛рдВ"] },
  { word: "рд░реЛрдЯреА", answers:["рд░реЛрдЯрд┐рдпрд╛рдБ","рд░реЛрдЯрд┐рдпрд╛рдВ"] },
  { word: "рдЧрд╛рдбрд╝реА", answers:["рдЧрд╛рдбрд╝рд┐рдпрд╛рдБ","рдЧрд╛рдбрд╝рд┐рдпрд╛рдВ"] },
  { word: "рдХреБрд░реНрд╕реА", answers:["рдХреБрд░реНрд╕рд┐рдпрд╛рдБ","рдХреБрд░реНрд╕рд┐рдпрд╛рдВ"] },
  { word: "рдХрд┐рддрд╛рдм", answers:["рдХрд┐рддрд╛рдмреЗрдВ","рдХрд┐рддрд╛рдмреЛрдВ"] },
  { word: "рд▓рдбрд╝рдХрд╛", answers:["рд▓рдбрд╝рдХреЗ","рд▓рдбрд╝рдХреЗрдВ"] },
  { word: "рд░реБрдкрдпрд╛", answers:["рд░реБрдкрдпреЗ","рд░реБрдкрдП"] },
  { word: "рдХрдорд░рд╛", answers:["рдХрдорд░реЗ","рдХрдорд░реЛрдВ"] },
  { word: "рддрд╕реНрд╡реАрд░", answers:["рддрд╕реНрд╡реАрд░реЗрдВ","рддрд╕реНрд╡реАрд░реЛрдВ"] },
  { word: "рд╕реЗрдм", answers:["рд╕реЗрдм","рд╕реЗрдмреЛрдВ"] }
];

// рд▓рд┐рдВрдЧ рдкреНрд░рд╢реНрди рдмрд┐рдирд╛ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ
const lingQuestions = [
  { word: "рд░рд╛рдЬрд╛", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рд░рд╛рдиреА"] },
  { word: "рд╢реЗрд░", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рд╢реЗрд░рдиреА"] },
  { word: "рдкрддрд┐", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рдкрддреНрдиреА"] },
  { word: "рдирд╛рдирд╛", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рдирд╛рдиреА"] },
  { word: "рдореБрд░реНрдЧрд╛", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рдореБрд░реНрдЧреА"] },
  { word: "рдкреБрддреНрд░", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рдкреБрддреНрд░реА"] },
  { word: "рдЕрдзреНрдпрд╛рдкрдХ", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рдЕрдзреНрдпрд╛рдкрд┐рдХрд╛"] },
  { word: "рд╕реЗрда", ask:"рд╕реНрддреНрд░реАрд▓рд┐рдВрдЧ", answers:["рд╕реЗрдард╛рдиреА","рд╕реЗрдардиреА"] },
  { word: "рд░рд╛рдиреА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рд░рд╛рдЬрд╛"] },
  { word: "рд╢реЗрд░рдиреА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рд╢реЗрд░"] },
  { word: "рдкрддреНрдиреА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рдкрддрд┐"] },
  { word: "рдирд╛рдиреА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рдирд╛рдирд╛"] },
  { word: "рдореБрд░реНрдЧреА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рдореБрд░реНрдЧрд╛"] },
  { word: "рдкреБрддреНрд░реА", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рдкреБрддреНрд░"] },
  { word: "рдЕрдзреНрдпрд╛рдкрд┐рдХрд╛", ask:"рдкреБрд▓реНрд▓рд┐рдВрдЧ", answers:["рдЕрдзреНрдпрд╛рдкрдХ"] }
];

let questions = [];
vachanQuestions.forEach(q => questions.push({type:'vachan',...q}));
lingQuestions.forEach(q => questions.push({type:'ling',...q}));

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}}
shuffle(questions);

let current=0,score=0,lastSpoken="",recognition=null,voice=null;

function chooseVoice(){
  const v=speechSynthesis.getVoices();
  const hi=v.filter(x=>/hi|hindi/i.test(x.lang||""));
  return hi.find(x=>/female|Aditi|Shruti|Google/.test(x.name))||hi[0]||v[0];
}
voice=chooseVoice();

function speak(txt){
  lastSpoken=txt;
  const u=new SpeechSynthesisUtterance(txt);
  u.lang="hi-IN";u.rate=0.95;if(voice)u.voice=voice;
  speechSynthesis.cancel();speechSynthesis.speak(u);
}

function normalize(s){return (s||"").normalize("NFD").replace(/[\u093C-\u094D\u0964-\u0965\s\p{P}]/gu,"").toLowerCase();}
function lev(a,b){if(a===b)return 0;let m=[],al=a.length,bl=b.length;
  for(let i=0;i<=al;i++){m[i]=[i];for(let j=1;j<=bl;j++)m[i][j]=i===0?j:0;}
  for(let i=1;i<=al;i++){for(let j=1;j<=bl;j++){m[i][j]=a[i-1]===b[j-1]?m[i-1][j-1]:Math.min(m[i-1][j]+1,m[i][j-1]+1,m[i-1][j-1]+1);}}return m[al][bl];}
function match(a,b){a=normalize(a);b=normalize(b);if(a===b)return true;return lev(a,b)<=Math.max(1,Math.floor(Math.max(a.length,b.length)*0.25));}

const qText=document.getElementById("questionText");
const ans=document.getElementById("answerInput");
const submitBtn=document.getElementById("submitBtn");
const passBtn=document.getElementById("passBtn");
const replayBtn=document.getElementById("replayBtn");
const speakBtn=document.getElementById("speakBtn");
const playBtn=document.getElementById("playBtn");
const scoreDiv=document.getElementById("score");
const feedback=document.getElementById("feedbackText");
const status=document.getElementById("status");

function nextQ(){
  if(current>=questions.length)return endQuiz();
  const q=questions[current];
  let prompt;
  if(q.type==="vachan"){
    prompt=`рд╡рдЪрди рдмрджрд▓рд┐рдП: ${q.word} рдХрд╛ рдмрд╣реБрд╡рдЪрди рдмрддрд╛рдЗрдП`;
  } else {
    prompt=`рд▓рд┐рдВрдЧ рдмрджрд▓рд┐рдП: ${q.word} рдХрд╛ ${q.ask} рдмрддрд╛рдЗрдП`;
  }
  qText.textContent=prompt;
  ans.value="";
  feedback.textContent="";
  ans.disabled=false;
  speak(prompt);
}

function correct(){
  score++;
  feedback.textContent="тЬЕ рд╕рд╣реА рдЙрддреНрддрд░!";
  feedback.style.color="#1a7f3a";
  speak("рд╕рд╣реА рдЙрддреНрддрд░");
  setTimeout(()=>{current++;nextQ();},2500);
}

function wrong(){
  feedback.textContent="тЭМ рдЧрд▓рдд рдЙрддреНрддрд░! рдлрд┐рд░ рд╕реЗ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдпрд╛ рдкрд╛рд╕ рджрдмрд╛рдПрдБред";
  feedback.style.color="#c00";
  speak("рдЧрд▓рдд рдЙрддреНрддрд░");
}

submitBtn.onclick=()=>{
  const val=ans.value.trim();
  if(!val)return;
  const q=questions[current];
  if(q.answers.some(x=>match(val,x)))correct();else wrong();
};

passBtn.onclick=()=>{current++;nextQ();};
replayBtn.onclick=()=>{if(lastSpoken)speak(lastSpoken);};
playBtn.onclick=()=>{
  current=0;score=0;shuffle(questions);
  scoreDiv.textContent="";
  nextQ();
};

try{
  const R=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(R){
    recognition=new R();
    recognition.lang="hi-IN";
    recognition.interimResults=false;
    recognition.maxAlternatives=1;
    recognition.onresult=e=>{
      const txt=e.results[0][0].transcript.trim();
      ans.value=txt;
      const q=questions[current];
      if(q.answers.some(x=>match(txt,x)))correct();else wrong();
    };
    recognition.onerror=e=>{status.textContent="ЁЯОЩя╕П рддреНрд░реБрдЯрд┐: "+e.error;};
    speakBtn.onclick=()=>{status.textContent="ЁЯОЩя╕П рд╕реБрди рд░рд╣рд╛ рд╣реВрдБ";try{recognition.start();}catch{};};
  }
}catch(e){console.warn(e);}

function endQuiz(){
  qText.textContent="рдХреНрд╡рд┐рдЬрд╝ рд╕рдорд╛рдкреНрдд!";
  ans.disabled=true;
  submitBtn.disabled=passBtn.disabled=speakBtn.disabled=replayBtn.disabled=true;
  scoreDiv.textContent=`рдЖрдкрдХрд╛ рд╕реНрдХреЛрд░: ${score} / ${questions.length}`;
  speak(`рдХреНрд╡рд┐рдЬрд╝ рд╕рдорд╛рдкреНрддред рдЖрдкрдХрд╛ рд╕реНрдХреЛрд░ ${score} рдореЗрдВ рд╕реЗ ${questions.length} рд╣реИред`);
}
</script>
</body>
</html>
